---
import Layout from '../layouts/Layout.astro';
import heroImg from '../assets/reading.avif';//'../assets/P1090543.jpg';
import libraryGroupImg from '../assets/library_group.avif';
import groupEventsImg from '../assets/group_event.avif';
import groupStudyImg from '../assets/group_study.avif';
import headphonesFunImg from '../assets/headphones_fun.avif';

import ActivitiesCarousel from '../components/ActivitiesCarousel.astro';
import { activities } from '../data/site.js';
---

<Layout>
	{/* Toast notification for successful subscription */}
	<div id="toast" class="toast toast-success" style="display: none;">
		<div class="toast-content">
			<span class="toast-icon">✓</span>
			<div class="toast-message">
				<strong>Thank you for subscribing!</strong>
				<p>We've added <span class="email-highlight" id="subscriber-email"></span> to our newsletter list.</p>
			</div>
		</div>
	</div>

	<section class="hero" style={`--hero-image: url(${heroImg.src})`}>
		<div class="hero-inner">
			<h1>
				<span>Knowledge is Peace</span>
			</h1>
			<p class="tagline">Community-run libraries for brighter futures in Uganda's refugee settlements</p>
		</div>
	</section>

	<section class="cards-section">
		<div class="cards-container">
			<div class="text-column">
				<h3>Our Mission</h3>
				<p>Uganda's Imvepi and Rhino refugee settlements were established to shelter people fleeing conflict in South Sudan. Today, one of the greatest needs that these communities face is access to education and reading. Creative Learning Haven was founded to meet this need by creating libraries and learning spaces, run by members of the communities they serve.</p>
				<br/>
				<!-- <a href="/about">Learn More About Who We Are →</a> -->
			</div>
			
			<div class="text-column">
				<h3>Support Us</h3>
				<p>Our libraries and activities are entirely crowd-funded. We have already reached 800+ people and circulated 2,000+ books. With your help, we can continue to provide educational resources and creative activities for these communities.</p>
				<br/>
				<a href="/support-us" class="learn-more-btn">Learn How You Can Help →</a>
			</div>
		</div>
	</section>

	<h2 class="activities-title">What We Do</h2>

	<ActivitiesCarousel activities={activities} />

	<section class="quote-banner" style={`--banner-image: url(${libraryGroupImg.src})`}>
		<div class="quote-overlay">
			<blockquote>
				"We don't want this generation of South Sudanese, Congolese, or Ugandans to miss the opportunity of education"
			</blockquote>
			<cite>- Peter Hardrock (CLH Imvepi Team Lead)</cite>
		</div>
	</section>

	<section class="content-row">
		<div class="content-text">
			<h2>Events</h2>
			<p>Check out our events page to see our exciting upcoming events, workshops, and activities — both in Uganda and the United States.</p>
			<a href="/events" class="learn-more-btn">Learn More →</a>
		</div>
		<div class="content-image">
			<img src={groupEventsImg.src} alt="Community members gathered together" />
		</div>
	</section>

	<section class="content-row content-row-reverse">
		<div class="content-image">
			<img src={headphonesFunImg.src} alt="Students studying together in the library" />
		</div>
		<div class="content-text">
			<h2>Socials</h2>
			<p>We are regularly putting out new content to showcase the lives and stories of our community. Follow along with us on our social media pages to see the latest updates.</p>
			<a href="/blog" class="learn-more-btn">Learn More →</a>
		</div>
	</section>

	{/* Newsletter Signup Section */}
	<section class="newsletter-signup">
		<div class="newsletter-container">
			<div class="newsletter-content">
				<h2>Stay Connected</h2>
				<p>Subscribe to our newsletter to learn how you can get involved and receive the latest updates on our work.</p>
				<form class="newsletter-form" action="/api/subscribe" method="POST">
					<div class="form-group">
						<input 
							type="email" 
							name="email" 
							placeholder="Enter your email address" 
							required
							class="newsletter-input"
						>
						<button type="submit" class="newsletter-button">Subscribe</button>
					</div>
				</form>
			</div>
		</div>
	</section>

	<script>
		// Check URL parameters and show toast if user just subscribed
		document.addEventListener('DOMContentLoaded', function() {
			const url = new URL(window.location.href);
			const subscribed = url.searchParams.get('subscribed');
			const email = url.searchParams.get('email');
			
			const toast = document.getElementById('toast');
			const emailSpan = document.getElementById('subscriber-email');
			
			if (subscribed === 'true' && email && toast && emailSpan) {
				// Set the email in the toast
				emailSpan.textContent = email;
				
				// Show the toast
				toast.style.display = 'block';
				
				// Auto-hide after 5 seconds
				setTimeout(() => {
					toast.classList.add('hiding');
					setTimeout(() => {
						toast.style.display = 'none';
						toast.classList.remove('hiding');
					}, 300); // Wait for animation to complete
				}, 5000); // Hide after 5 seconds
			}
		});
	</script>
</Layout>

<style>
	.hero {
		position: relative;
		min-height: 60vh;
		color: white;
		display: grid;
		place-items: center;
		z-index: 0;
		overflow: hidden;
	}

	.hero::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background-image: var(--hero-image);
		background-size: cover;
		background-position: top center;
		background-repeat: no-repeat;
		z-index: -2;
	}

	.hero::after {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		background: var(--overlay-dark);
		z-index: -1;
	}

	.hero-inner {
		/* max-width: 940px; */
		padding: 4vh 16px 5vh;
		text-align: center;
	}

	/* Staggered rise-in animation for hero content (slower + stronger) */
	.hero-inner > * {
		opacity: 0;
		transform: translateY(100px);
		animation: riseIn 1.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
	}

	.hero-inner > *:nth-child(1) { animation-delay: .15s; }
	.hero-inner > *:nth-child(2) { animation-delay: .35s; }
	.hero-inner > *:nth-child(3) { animation-delay: .55s; }

	@keyframes riseIn {
		from { opacity: 0; transform: translateY(60px); filter: blur(4px); }
		to { opacity: 1; transform: translateY(0); filter: blur(0); }
	}

	@media (prefers-reduced-motion: reduce) {
		.hero-inner > * { animation: none; opacity: 1; transform: none; filter: none; }
	}

	/* Cards Section Styles */
	.cards-section {
		padding: 60px 16px;
		background: var(--section-light);
	}

	.cards-container {
		max-width: 1200px;
		margin: 0 auto;
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: 60px;
		position: relative;
	}

	.cards-container::after {
		content: '';
		position: absolute;
		left: 50%;
		top: 0;
		bottom: 0;
		width: 2px;
		background: var(--color-subscribe-dark);
		opacity: 0.3;
		transform: translateX(-50%);
	}

	.text-column h3 {
		font-size: 24px;
		margin: 0 0 20px 0;
		color: var(--color-subscribe-dark);
		font-family: 'Lulo Clean Custom', 'Avenir Custom', Avenir, Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
		text-transform: uppercase;
	}

	.text-column p {
		font-size: 18px;
		line-height: 1.7;
		color: var(--color-text);
		margin: 0;
	}

	.text-column ul {
		list-style-type: disc;
		padding-left: 20px;
		font-size: 18px;
		line-height: 1.7;
		color: var(--color-text);
		margin: 0;
	}

	.button-container {
		text-align: center;
		margin-top: 20px;
	}

	@media (max-width: 900px) {
		.cards-container {
			grid-template-columns: 1fr;
			gap: 40px;
		}
	}

	@media (max-width: 600px) {
		.cards-section {
			padding: 40px 16px;
		}
		
		.text-column h3 {
			font-size: 20px;
		}
		
		.text-column p {
			font-size: 16px;
		}
	}

	.tagline {
		display: inline-block;
		font-size: 1.4em;
		max-width: 1400px;
		padding: 8px 14px;
		margin-top: 60px;
		border-radius: 10px;
		letter-spacing: .08em;
		font-weight: 800; // uses Avenir Heavy
		text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
	}

	h1 {
		margin: 10px 0 6px;
		/* font-size: clamp(34px, 7vw, 76px); */
		font-size: 50px;
		line-height: 0.95;
		text-transform: uppercase;
		text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
	}

	.line2 { display: block; font-size: 1.1em; }

	.subtitle {
		max-width: 780px;
		margin: 12px auto 0;
		font-size: clamp(16px, 2.2vw, 20px);
		color: var(--white-strong);
		text-shadow: 0 1px 2px rgba(0,0,0,0.25);
	}

	.panels {
		display: grid;
		/* Left column wider than right; right ≈ 60% of left (5:3 ratio) */
		grid-template-columns: 5fr 3fr;
		grid-template-rows: auto auto;
		gap: 0;
		max-width: 98%;
		margin: 16px auto 0;
		padding: 0 16px;
		position: relative;
		z-index: 1;
	}

	.panel { padding: 36px 32px; min-height: 280px; }

	.mission { background: var(--section-light); }

	.pledge {
		background: var(--color-pledge-red);
		color: var(--color-pledge-red-text);
		display: grid;
		place-items: center;
		text-align: center;
	}

	.pledge .cta {
		background: var(--color-white);
		color: var(--color-pledge-cta-text);
		text-decoration: none;
		font-weight: 800;
		padding: 12px 18px;
		border-radius: 999px;
		box-shadow: inset 0 -2px 0 rgba(0,0,0,.2);
		transition: background .2s ease, color .2s ease, border-color .2s ease;
	}

	.pledge .cta:hover,
	.pledge .cta:focus-visible { background: var(--section-light); color: var(--color-pledge-cta-text); }

	.socials { background: var(--color-socials-green); color: var(--color-teal-ink); }
	.socials .link { color: var(--color-teal-ink); font-weight: 700; }

	.subscribe { background: var(--color-subscribe-dark); color: var(--color-subscribe-foreground); }
	.subscribe-form { display: flex; gap: 8px; margin-top: 8px; }
	.subscribe-form input {
		flex: 1;
		min-width: 0;
		padding: 10px 12px;
		border-radius: 8px;
		border: 1px solid var(--color-subscribe-input-border);
		background: var(--color-subscribe-input-bg);
		color: var(--color-subscribe-input-text);
	}
	.subscribe-form button {
		background: var(--color-accent);
		color: var(--color-teal-ink);
		border: 0;
		border-radius: 8px;
		padding: 10px 14px;
		font-weight: 800;
	}

	.link { display: inline-block; margin-top: 12px; font-weight: 700; color: var(--color-link-strong); }

	@media (max-width: 900px) {
		.panels { grid-template-columns: 1fr; }
		.panel { min-height: 220px; }
	}

	.activities-title {
		/* margin: 60px 0; */
		margin-top: 80px;
		margin-bottom: 0;
		text-align: center;
		color: var(--color-subscribe-dark);
		font-family: 'Lulo Clean Custom', 'Avenir Custom', Avenir, Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
		text-transform: uppercase;
		font-size: clamp(18px, 2em, 40px);
	}

	/* Toast notification styles */
	.toast {
		position: fixed;
		top: 80px; /* Below the navbar */
		left: 50%;
		transform: translateX(-50%);
		z-index: 1000;
		max-width: 90vw;
		width: 400px;
		border-radius: 12px;
		box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
		animation: toastSlideIn 0.3s ease-out;
	}

	.toast-success {
		background: linear-gradient(135deg, #4ade80, #22c55e);
		color: white;
		border: 1px solid #16a34a;
	}

	.toast-content {
		display: flex;
		align-items: flex-start;
		gap: 12px;
		padding: 16px 20px;
	}

	.toast-icon {
		font-size: 20px;
		font-weight: bold;
		color: white;
		flex-shrink: 0;
		margin-top: 2px;
	}

	.toast-message {
		flex: 1;
	}

	.toast-message strong {
		display: block;
		font-size: 16px;
		margin-bottom: 4px;
	}

	.toast-message p {
		margin: 0;
		font-size: 14px;
		opacity: 0.95;
		line-height: 1.4;
	}

	.email-highlight {
		background: rgba(255, 255, 255, 0.2);
		padding: 2px 6px;
		border-radius: 4px;
		font-family: monospace;
		font-weight: 600;
	}

	@keyframes toastSlideIn {
		from {
			opacity: 0;
			transform: translateX(-50%) translateY(-20px);
		}
		to {
			opacity: 1;
			transform: translateX(-50%) translateY(0);
		}
	}

	@keyframes toastSlideOut {
		from {
			opacity: 1;
			transform: translateX(-50%) translateY(0);
		}
		to {
			opacity: 0;
			transform: translateX(-50%) translateY(-20px);
		}
	}

	.toast.hiding {
		animation: toastSlideOut 0.3s ease-in forwards;
	}

	/* Activity sections styles */
	.activity-section {
		margin: 60px auto;
		max-width: 1200px;
		padding: 0 16px;
	}

	.activity-content {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 60px;
		align-items: center;
	}

	.activity-content.reverse {
		direction: rtl;
	}

	.activity-content.reverse > * {
		direction: ltr;
	}

	.activity-text h3 {
		font-size: clamp(14px, 2vw, 28px);
		margin-bottom: 20px;
		color: var(--color-subscribe-dark);
		font-family: 'Lulo Clean Custom', 'Avenir Custom', Avenir, Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
		text-transform: uppercase;
	}

	.activity-text p {
		font-size: 18px;
		line-height: 1.6;
		color: var(--color-text);
		margin: 0;
	}

	.learn-more-btn {
		display: inline-block;
		margin-top: 20px;
		padding: 12px 24px;
		background: var(--color-subscribe-dark);
		color: white;
		text-decoration: none;
		border-radius: 8px;
		font-weight: 700;
		transition: all 0.2s ease;
		box-shadow: 0 2px 4px rgba(0,0,0,0.1);
	}

	.learn-more-btn:hover {
		background: var(--color-accent);
		transform: translateY(-2px);
		box-shadow: 0 4px 8px rgba(0,0,0,0.15);
	}

	.activity-images {
		display: flex;
		justify-content: center;
		align-items: center;
	}

	.image-collage {
		display: grid;
		grid-template-columns: 1fr 1fr;
		grid-template-rows: 1fr 1fr;
		gap: 12px;
		width: 100%;
		max-width: 400px;
		aspect-ratio: 1;
	}

	.image-placeholder {
		background: var(--section-light);
		border: 2px dashed var(--color-subscribe-dark);
		border-radius: 8px;
		display: flex;
		align-items: center;
		justify-content: center;
		color: var(--color-subscribe-dark);
		font-weight: 600;
		font-size: 14px;
		transition: all 0.2s ease;
	}

	.learn-more-btn {
		display: inline-block;
		margin-top: 20px;
		padding: 12px 24px;
		background: var(--color-subscribe-dark);
		color: white;
		text-decoration: none;
		border-radius: 8px;
		font-weight: 700;
		transition: all 0.2s ease;
		box-shadow: 0 2px 4px rgba(0,0,0,0.1);
	}

	.learn-more-btn:hover {
		background: var(--color-accent);
		transform: translateY(-2px);
		box-shadow: 0 4px 8px rgba(0,0,0,0.15);
	}

	@media (max-width: 768px) {
		.activity-content {
			grid-template-columns: 1fr;
			gap: 40px;
		}

		.activity-content.reverse {
			direction: ltr;
		}

		.activity-section {
			margin: 40px auto;
		}

		.image-collage {
			max-width: 300px;
		}
	}

	/* Quote Banner Styles */
	.quote-banner {
		position: relative;
		min-height: 700px; /* Adjust as needed */
		display: flex;
		align-items: center;
		justify-content: center;
		background-image: var(--banner-image);
		background-size: cover;
		background-position: center;
		background-repeat: no-repeat;
		color: white;
		text-align: left;
		padding: 40px 16px;
		margin-top: 80px;
		margin-bottom: 80px;
		z-index: 0;
	}

	.quote-banner::before {
		content: '';
		position: absolute;
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		z-index: -1;
	}

	.quote-overlay {
		position: absolute;
		bottom: 40px;
		left: 40px;
		z-index: 1;
		max-width: 600px;
		padding: 20px;
		background: rgba(0, 0, 0, 0.8);
		box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
		border-radius: 8px;
	}

	.quote-overlay blockquote {
		font-size: 24px;
		line-height: 1.6;
		font-style: italic;
		color: var(--white-strong);
		margin-bottom: 15px;
		padding-left: 20px;
	}

	.quote-overlay cite {
		font-size: 18px;
		font-style: normal;
		color: var(--white-strong);
		display: block;
		text-align: right;
		margin-top: 10px;
	}

	@media (max-width: 768px) {
		.quote-banner {
			min-height: 250px;
			padding: 30px 16px;
		}

		.quote-overlay {
			bottom: 20px;
			left: 20px;
			right: 20px;
			max-width: none;
			padding: 20px;
		}

		.quote-overlay blockquote {
			font-size: 18px;
			padding-left: 15px;
		}

		.quote-overlay cite {
			font-size: 14px;
		}
	}

	/* Content Row Styles */
	.content-row {
		display: flex;
		align-items: center;
		gap: 60px;
		max-width: 1200px;
		margin: 80px auto;
		padding: 0 20px;
	}

	.content-text {
		flex: 1;
	}

	.content-text h2 {
		font-size: 32px;
		color: var(--primary-color, #2c5530);
		margin-bottom: 20px;
		font-weight: 600;
	}

	.content-text p {
		font-size: 18px;
		line-height: 1.7;
		color: var(--text-color, #333);
		margin-bottom: 0;
	}

	.content-image {
		flex: 1;
		display: flex;
		justify-content: center;
		align-items: center;
	}

	.content-image img {
		max-width: 100%;
		height: auto;
		border-radius: 12px;
		box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
	}

	@media (max-width: 768px) {
		.content-row {
			flex-direction: column;
			gap: 40px;
			margin: 60px auto;
			padding: 0 16px;
		}

		.content-row-reverse {
			flex-direction: column;
		}

		.content-text h2 {
			font-size: 28px;
		}

		.content-text p {
			font-size: 16px;
		}
	}

	/* Newsletter Signup Styles */
	.newsletter-signup {
		padding: 80px 16px;
		background: var(--section-light);
		text-align: left;
	}

	.newsletter-container {
		max-width: 900px;
		margin: 0 auto;
	}

	.newsletter-content h2 {
		font-size: 28px;
		color: var(--color-subscribe-dark);
		margin-bottom: 15px;
		font-family: 'Lulo Clean Custom', 'Avenir Custom', Avenir, Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
		text-transform: uppercase;
	}

	.newsletter-content p {
		font-size: 18px;
		line-height: 1.7;
		color: var(--color-text);
		margin-bottom: 30px;
	}

	.newsletter-form {
		display: flex;
		justify-content: flex-start;
		gap: 10px;
	}

	.form-group {
		display: flex;
		align-items: center;
		gap: 10px;
		background: var(--color-white);
		border-radius: 8px;
		box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
		overflow: hidden;
		min-width: 400px;
	}

	.newsletter-input {
		flex: 1;
		padding: 12px 16px;
		border: none;
		outline: none;
		font-size: 16px;
		color: var(--color-text);
	}

	.newsletter-button {
		background: var(--color-accent);
		color: var(--color-teal-ink);
		border: none;
		padding: 12px 20px;
		border-radius: 8px;
		font-weight: 800;
		cursor: pointer;
		transition: background 0.2s ease;
		white-space: nowrap;
	}

	.newsletter-button:hover {
		background: var(--color-accent-dark);
	}

	@media (max-width: 768px) {
		.newsletter-signup {
			padding: 60px 16px;
		}

		.newsletter-content h2 {
			font-size: 24px;
		}

		.newsletter-content p {
			font-size: 16px;
		}

		.newsletter-form {
			flex-direction: column;
			align-items: stretch;
			gap: 10px;
		}

		.form-group {
			flex-direction: column;
			align-items: stretch;
			width: 100%;
			min-width: auto;
		}

		.newsletter-input {
			padding: 10px 16px;
		}

		.newsletter-button {
			padding: 10px 16px;
			width: 100%;
		}
	}


</style>
